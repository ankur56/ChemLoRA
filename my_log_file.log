2023-03-28 15:17:15.051 | DEBUG    | gptchem.tuner:tune:188 - Requested fine tuning. {
  "created_at": 1680041834,
  "events": [
    {
      "created_at": 1680041834,
      "level": "info",
      "message": "Created fine-tune: ft-D0re8qt09466hxoUy4JsHfc3",
      "object": "fine-tune-event"
    }
  ],
  "fine_tuned_model": null,
  "hyperparams": {
    "batch_size": null,
    "learning_rate_multiplier": null,
    "n_epochs": 4,
    "prompt_loss_weight": 0.01
  },
  "id": "ft-D0re8qt09466hxoUy4JsHfc3",
  "model": "ada",
  "object": "fine-tune",
  "organization_id": "org-cAB9LS3wUMwYPzofgTtJct7R",
  "result_files": [],
  "status": "pending",
  "training_files": [
    {
      "bytes": 19230496,
      "created_at": 1680041834,
      "filename": "/home/ankur/Documents/gpt/out/20230328_151711/train.jsonl",
      "id": "file-AZTWbYIPtz2NwD37VBzW1Bxk",
      "object": "file",
      "purpose": "fine-tune",
      "status": "uploaded",
      "status_details": null
    }
  ],
  "updated_at": 1680041834,
  "validation_files": []
}
2023-03-28 15:17:15.131 | DEBUG    | gptchem.tuner:get_ft_model_name:29 - Fine tuning status: pending
2023-03-28 15:19:15.458 | DEBUG    | gptchem.tuner:get_ft_model_name:29 - Fine tuning status: pending
2023-03-28 15:21:15.658 | DEBUG    | gptchem.tuner:get_ft_model_name:29 - Fine tuning status: failed
2023-03-28 15:21:15.659 | ERROR    | gptchem.tuner:tune:197 - Fine tuning failed.
Traceback (most recent call last):

  File "/home/ankur/Documents/gpt/gpt-3_test_2.py", line 40, in <module>
    tune_summary = tuner(train)
                   │     └                                                    prompt  ...       representation
                   │       100331  What is the atomization energy in...
                   └ gptchem.tuner.Tuner(base_model='ada', batch_size=None, n_epochs=4, learning_rate_multiplier=None, run_name=None)

  File "/home/ankur/miniconda3/envs/chemgpt/lib/python3.9/site-packages/gptchem/tuner.py", line 213, in __call__
    return self.tune(train_df, validation_df)
           │    │    │         └ None
           │    │    └                                                    prompt  ...       representation
           │    │      100331  What is the atomization energy in...
           │    └ <function Tuner.tune at 0x14749942a280>
           └ gptchem.tuner.Tuner(base_model='ada', batch_size=None, n_epochs=4, learning_rate_multiplier=None, run_name=None)
> File "/home/ankur/miniconda3/envs/chemgpt/lib/python3.9/site-packages/gptchem/tuner.py", line 192, in tune
    modelname = get_ft_model_name(ft_id, self._sleep)
                │                 │      │    └ 120
                │                 │      └ gptchem.tuner.Tuner(base_model='ada', batch_size=None, n_epochs=4, learning_rate_multiplier=None, run_name=None)
                │                 └ 'ft-D0re8qt09466hxoUy4JsHfc3'
                └ <function get_ft_model_name at 0x1474994b2700>
  File "/home/ankur/miniconda3/envs/chemgpt/lib/python3.9/site-packages/gptchem/tuner.py", line 33, in get_ft_model_name
    raise RuntimeError(f"Fine tuning failed: {ft}")

RuntimeError: Fine tuning failed: {
  "created_at": 1680041834,
  "events": [
    {
      "created_at": 1680041834,
      "level": "info",
      "message": "Created fine-tune: ft-D0re8qt09466hxoUy4JsHfc3",
      "object": "fine-tune-event"
    },
    {
      "created_at": 1680042003,
      "level": "error",
      "message": "Fine-tune failed. Fine-tune will exceed free trial credits",
      "object": "fine-tune-event"
    }
  ],
  "fine_tuned_model": null,
  "hyperparams": {
    "batch_size": null,
    "learning_rate_multiplier": null,
    "n_epochs": 4,
    "prompt_loss_weight": 0.01
  },
  "id": "ft-D0re8qt09466hxoUy4JsHfc3",
  "model": "ada",
  "object": "fine-tune",
  "organization_id": "org-cAB9LS3wUMwYPzofgTtJct7R",
  "result_files": [],
  "status": "failed",
  "training_files": [
    {
      "bytes": 19230496,
      "created_at": 1680041834,
      "filename": "/home/ankur/Documents/gpt/out/20230328_151711/train.jsonl",
      "id": "file-AZTWbYIPtz2NwD37VBzW1Bxk",
      "object": "file",
      "purpose": "fine-tune",
      "status": "processed",
      "status_details": null
    }
  ],
  "updated_at": 1680042003,
  "validation_files": []
}
